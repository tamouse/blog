<!DOCTYPE html>
<html><head>
  <title>TamWiki | Main / wp.pl irssi script</title>
  <link rel='stylesheet' href='http://wiki.tamouse.org/pub/skins/print/print.css' type='text/css' />
</head>
<body>
<!--PageText-->
<div id='wikitext'>
<p class='vspace'>Wikipedia is a great source of information on the web. This script
grabs a summary of a wikipedia page and presents the result back to
the channel the bot was activated from.
</p>
<p class='vspace'>The script uses a <a class='external' href='https://dgl.cx/wikipedia-dns' target='_blank'>functionality</a> that a lot of people don't know about:
someone has created a small database of wikipedia summaries that are
requested and returned via a DNS
query.
</p>
<p class='vspace'>Since we're in Perl, there's a nifty Perl implementation as well:
</p>
<div class='sourceblock ' id='sourceblock1'>
  <div class='sourceblocktext'><div class="perl"><div class="head">"Getting wikipedia
summaries via DNS in Perl"</div><ol><li class="li1"><div class="de1"><span class="kw2">use</span> Net<span class="sy0">::</span><span class="me2">DNS</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1"><span class="kw1">my</span> <span class="re0">$res</span> <span class="sy0">=</span> Net<span class="sy0">::</span><span class="me2">DNS</span><span class="sy0">::</span><span class="me2">Resolver</span><span class="sy0">-&gt;</span><span class="kw2">new</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1">&nbsp;</div></li>
<li class="li1"><div class="de1"><span class="kw2">sub</span> wikipedia <span class="br0">&#123;</span></div></li>
<li class="li2"><div class="de2">&nbsp; <span class="kw1">my</span><span class="br0">&#40;</span><span class="re0">$name</span><span class="br0">&#41;</span> <span class="sy0">=</span> <span class="co5">@_</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1">&nbsp; <span class="kw1">my</span> <span class="re0">$q</span> <span class="sy0">=</span> <span class="re0">$res</span><span class="sy0">-&gt;</span><span class="me1">query</span><span class="br0">&#40;</span><span class="st0">&quot;$name.wp.dg.cx&quot;</span><span class="sy0">,</span> <span class="st0">&quot;TXT&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1">&nbsp; <span class="kw1">if</span><span class="br0">&#40;</span><span class="re0">$q</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="kw1">for</span> <span class="kw1">my</span> <span class="re0">$rr</span><span class="br0">&#40;</span><span class="re0">$q</span><span class="sy0">-&gt;</span><span class="me1">answer</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; &nbsp; <span class="kw1">next</span> <span class="kw1">unless</span> <span class="re0">$rr</span><span class="sy0">-&gt;</span><span class="me1">type</span> <span class="kw1">eq</span> <span class="st0">&quot;TXT&quot;</span><span class="sy0">;</span></div></li>
<li class="li2"><div class="de2">&nbsp; &nbsp; &nbsp; <span class="kw3">return</span> <span class="kw3">join</span> <span class="st0">&quot;&quot;</span><span class="sy0">,</span> <span class="re0">$rr</span><span class="sy0">-&gt;</span><span class="me1">char_str_list</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="br0">&#125;</span></div></li>
<li class="li1"><div class="de1">&nbsp; <span class="br0">&#125;</span></div></li>
<li class="li1"><div class="de1"><span class="br0">&#125;</span></div></li>
</ol></div></div>
  <div class='sourceblocklink'><a href='http://wiki.tamouse.org?n=Main.Wp?action=sourceblock&amp;num=1' type='text/plain'>raw code</a></div>
</div>

<p class='vspace'>The script responds to a message in a channel or a query containing:
</p>
<div class='vspace'></div><pre> !wp &lt;WIKIPEDIA PAGE&gt;
</pre><p class='vspace'>And presents the information back to the channel or query as an
action.
</p>
<p class='vspace'>The script can be found here:
<a class='external' href='http://public.tamaratemple.com/irssi/wp.pl.txt' target='_blank'>http://public.tamaratemple.com/irssi/wp.pl.txt</a>
</p>
<div class='vspace'></div>
</div>

</body>
</html>
