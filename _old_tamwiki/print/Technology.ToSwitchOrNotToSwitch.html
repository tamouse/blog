<!DOCTYPE html>
<html><head>
  <title>TamWiki | Technology / ToSwitchOrNotToSwitch</title>
  <link rel='stylesheet' href='http://wiki.tamouse.org/pub/skins/print/print.css' type='text/css' />
</head>
<body>
<!--PageText-->
<div id='wikitext'>
<p><a name='excerpt' id='excerpt'></a>
When it comes to choosing when to use the <code><a class='external' href='http://us.php.net/manual/en/control-structures.switch.php' target='_blank'>switch</a></code> control structure, vs. a chain of <code>if-elseif-else</code> statements, there are many opinions. Many find chains of <code>if-elseif-else</code> statements to be crude and ugly. That said, sometimes there is no alternative. Fortunately, in PHP and Perl, there usually are alternative. The <code>switch</code> control structure is remarkably flexible in what it can do.
<a name='excerptend' id='excerptend'></a>
</p>
<div class='vspace'></div><h2>Let's compare</h2>
<p>A typical cascading <code>if-elseif-else</code> structure:
</p>
<div class='vspace'></div>
<div class='sourceblock ' id='sourceblock1'>
  <div class='sourceblocktext'><div class="php"><ol><li class="li1"><div class="de1"><span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$result</span> <span class="sy0">==</span> <span class="st_h">'image/jpeg'</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="re0">$ext</span> <span class="sy0">=</span> <span class="st_h">'jpg'</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1"><span class="br0">&#125;</span> <span class="kw1">elseif</span> <span class="br0">&#40;</span><span class="re0">$result</span> <span class="sy0">==</span> <span class="st0">&quot;image/gif&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="re0">$ext</span> <span class="sy0">=</span> <span class="st0">&quot;gif&quot;</span><span class="sy0">;</span></div></li>
<li class="li2"><div class="de2"><span class="br0">&#125;</span> <span class="kw1">elseif</span> <span class="br0">&#40;</span><span class="re0">$result</span> <span class="sy0">==</span> <span class="st0">&quot;image/png&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="re0">$ext</span> <span class="sy0">=</span> <span class="st0">&quot;png&quot;</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1"><span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="re0">$ext</span> <span class="sy0">=</span> <span class="st0">&quot;dat&quot;</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1"><span class="br0">&#125;</span></div></li>
</ol></div></div>
  <div class='sourceblocklink'><a href='http://wiki.tamouse.org?n=Technology.ToSwitchOrNotToSwitch?action=sourceblock&amp;num=1' type='text/plain'>raw code</a></div>
</div>

<p class='vspace'>Whereas, if we were to use a <code>switch</code> statement, we'd get:
</p>
<div class='vspace'></div>
<div class='sourceblock ' id='sourceblock2'>
  <div class='sourceblocktext'><div class="php"><ol><li class="li1"><div class="de1"><span class="kw1">switch</span> <span class="br0">&#40;</span><span class="re0">$result</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="kw1">case</span> <span class="st_h">'image/jpeg'</span><span class="sy0">:</span> <span class="re0">$ext</span> <span class="sy0">=</span> <span class="st0">&quot;jpg&quot;</span><span class="sy0">;</span> <span class="kw1">break</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="kw1">case</span> <span class="st_h">'image/gif'</span><span class="sy0">:</span> <span class="re0">$ext</span> <span class="sy0">=</span> <span class="st0">&quot;gif&quot;</span><span class="sy0">;</span> <span class="kw1">break</span><span class="sy0">;</span>&nbsp; &nbsp; &nbsp; </div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="kw1">case</span> <span class="st_h">'image/png'</span><span class="sy0">:</span> <span class="re0">$ext</span> <span class="sy0">=</span> <span class="st0">&quot;png&quot;</span><span class="sy0">;</span> <span class="kw1">break</span><span class="sy0">;</span>&nbsp; &nbsp; &nbsp; </div></li>
<li class="li2"><div class="de2">&nbsp; &nbsp; <span class="kw1">default</span><span class="sy0">:</span> <span class="re0">$ext</span> <span class="sy0">=</span> <span class="st0">&quot;dat&quot;</span><span class="sy0">;</span> <span class="kw1">break</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1">&nbsp; <span class="br0">&#125;</span></div></li>
</ol></div></div>
  <div class='sourceblocklink'><a href='http://wiki.tamouse.org?n=Technology.ToSwitchOrNotToSwitch?action=sourceblock&amp;num=2' type='text/plain'>raw code</a></div>
</div>

<p class='vspace'>Which seems more elegant and readable to you? I tend to vote for the <code>switch</code> implementation over the cascading <code>if-elseif-else</code> structure.
</p>
<div class='vspace'></div><h2>Another alternative</h2>
<p>While the above example shows the difference plainly between <code>if-elseif-else</code> and <code>switch</code> statements, there is actually a better alternative in this case: a lookup table.
</p>
<p class='vspace'>Somewhere in your source, create a lookup table:
</p>
<div class='sourceblock ' id='sourceblock3'>
  <div class='sourceblocktext'><div class="php"><ol><li class="li1"><div class="de1"><span class="re0">$mapmimetoextension</span> <span class="sy0">=</span> <span class="br0">&#40;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="st_h">'image/jpeg'</span> <span class="sy0">=&gt;</span> <span class="st_h">'jpg'</span><span class="sy0">,</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="st_h">'image/gif'</span> <span class="sy0">=&gt;</span> <span class="st_h">'gif'</span><span class="sy0">,</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="st_h">'image/png'</span> <span class="sy0">=&gt;</span> <span class="st_h">'png'</span><span class="sy0">,</span></div></li>
<li class="li2"><div class="de2">&nbsp; &nbsp; <span class="co2"># ... and so on</span></div></li>
<li class="li1"><div class="de1"><span class="br0">&#41;</span><span class="sy0">;</span></div></li>
</ol></div></div>
  <div class='sourceblocklink'><a href='http://wiki.tamouse.org?n=Technology.ToSwitchOrNotToSwitch?action=sourceblock&amp;num=3' type='text/plain'>raw code</a></div>
</div>

<p class='vspace'>Then, to determine the extension given the mimetype, you could simply do:
</p>
<div class='sourceblock ' id='sourceblock4'>
  <div class='sourceblocktext'><div class="php"><ol><li class="li1"><div class="de1"><span class="re0">$ext</span> <span class="sy0">=</span> <span class="kw3">isset</span><span class="br0">&#40;</span><span class="re0">$mapmimetoextension</span><span class="br0">&#91;</span><span class="re0">$mimetype</span><span class="br0">&#93;</span> ? <span class="re0">$mapmimetoextension</span><span class="br0">&#91;</span><span class="re0">$mimetype</span><span class="br0">&#93;</span> <span class="sy0">:</span> <span class="st_h">'dat'</span><span class="sy0">;</span></div></li>
</ol></div></div>
  <div class='sourceblocklink'><a href='http://wiki.tamouse.org?n=Technology.ToSwitchOrNotToSwitch?action=sourceblock&amp;num=4' type='text/plain'>raw code</a></div>
</div>

<p class='vspace'>Which seems a lot cheaper than either the cascading <code>if-elseif-else</code> or the <code>switch</code>. Given the desire to keep code modular, it would also likely save on a procedure call.
</p>
<p class='vspace'>That's fine for PHP, what about Perl?
</p>
<div class='vspace'></div><h2>Perl Switch Constructs</h2>
<p>Unlike some other programming languages, Perl has no official switch or case statement. That's because Perl doesn't need one, having many ways to do the same thing. A bare block is particularly convenient for doing case structures (multiway switches). Here's one:
</p>
<div class='vspace'></div>
<div class='sourceblock ' id='sourceblock5'>
  <div class='sourceblocktext'><div class="perl"><ol><li class="li1"><div class="de1">SWITCH<span class="sy0">:</span> <span class="br0">&#123;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span><span class="co2">/^abc/</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$abc</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span> <span class="kw1">last</span> SWITCH<span class="sy0">;</span> <span class="br0">&#125;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span><span class="co2">/^def/</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$def</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span> <span class="kw1">last</span> SWITCH<span class="sy0">;</span> <span class="br0">&#125;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span><span class="co2">/^xyz/</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$xyz</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span> <span class="kw1">last</span> SWITCH<span class="sy0">;</span> <span class="br0">&#125;</span></div></li>
<li class="li2"><div class="de2">&nbsp; &nbsp; <span class="re0">$nothing</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1"><span class="br0">&#125;</span></div></li>
</ol></div></div>
  <div class='sourceblocklink'><a href='http://wiki.tamouse.org?n=Technology.ToSwitchOrNotToSwitch?action=sourceblock&amp;num=5' type='text/plain'>raw code</a></div>
</div>

<p class='vspace'>and here's another:
</p>
<div class='vspace'></div>
<div class='sourceblock ' id='sourceblock6'>
  <div class='sourceblocktext'><div class="perl"><ol><li class="li1"><div class="de1">SWITCH<span class="sy0">:</span> <span class="br0">&#123;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="co2">/^abc/</span> &nbsp; &nbsp; &nbsp;<span class="sy0">&amp;&amp;</span> <span class="kw1">do</span> <span class="br0">&#123;</span> <span class="re0">$abc</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span> <span class="kw1">last</span> SWITCH<span class="sy0">;</span> <span class="br0">&#125;</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="co2">/^def/</span> &nbsp; &nbsp; &nbsp;<span class="sy0">&amp;&amp;</span> <span class="kw1">do</span> <span class="br0">&#123;</span> <span class="re0">$def</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span> <span class="kw1">last</span> SWITCH<span class="sy0">;</span> <span class="br0">&#125;</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="co2">/^xyz/</span> &nbsp; &nbsp; &nbsp;<span class="sy0">&amp;&amp;</span> <span class="kw1">do</span> <span class="br0">&#123;</span> <span class="re0">$xyz</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span> <span class="kw1">last</span> SWITCH<span class="sy0">;</span> <span class="br0">&#125;</span><span class="sy0">;</span></div></li>
<li class="li2"><div class="de2">&nbsp; &nbsp; <span class="re0">$nothing</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1"><span class="br0">&#125;</span></div></li>
</ol></div></div>
  <div class='sourceblocklink'><a href='http://wiki.tamouse.org?n=Technology.ToSwitchOrNotToSwitch?action=sourceblock&amp;num=6' type='text/plain'>raw code</a></div>
</div>

<p class='vspace'>Both of these constructs operate on matching the <code>$_</code> variable. I prefer the second form (no nasty if's going on there. Note that the both forms can be much more convoluted there. There is no need to necessarily restrict one's self to making comparisons with the <code>$_</code> variable. Basically <em>any</em> test can be made in the case portion of the switch construct. 
</p>
<p class='vspace'>What makes this work is the <code>last SWITCH;</code> statement. It basically quits the switch when it is executed.
</p>
<div class='vspace'></div>
</div>

</body>
</html>
