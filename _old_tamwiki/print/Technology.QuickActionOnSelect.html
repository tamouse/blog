<!DOCTYPE html>
<html><head>
  <title>TamWiki | Technology / QuickActionOnSelect</title>
  <link rel='stylesheet' href='http://wiki.tamouse.org/pub/skins/print/print.css' type='text/css' />
</head>
<body>
<!--PageText-->
<div id='wikitext'>
<p class='vspace'><a name='excerpt' id='excerpt'></a>
This is a quick and dirty way of getting your web page to respond to a change in value of a non-form-enclosed <code>&lt;select&gt;</code> tag. This is useful for causing changes to happen based on some specific set of values that you want to offer the user. First I will give the general form, then offer a specific example from some recent work I have done.
<a name='excerptend' id='excerptend'></a>
</p>
<p class='vspace'><a name='generalform' id='generalform'></a>
</p><h2>General Form</h2>
<p>The concept here is that we use the <code>onchange</code> attribute of the <code>&lt;select&gt;</code> tag to trigger a little javascript to do something with the value of the <code>&lt;option&gt;</code> tag that has been selected.
</p>
<div class='vspace'></div>
<div class='sourceblock ' id='sourceblock1'>
  <div class='sourceblocktext'><div class="html4strict"><ol><li class="li1"><div class="de1"><span class="sc2">&lt;<span class="kw2">select</span> <span class="kw3">name</span><span class="sy0">=</span><span class="st0">&quot;myselect&quot;</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;myselect&quot;</span> <span class="kw3">onchange</span><span class="sy0">=</span><span class="st0">&quot;dosomething(this.value)&quot;</span> <span class="kw3">size</span><span class="sy0">=</span><span class="st0">&quot;1&quot;</span>&gt;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;option1&quot;</span>&gt;</span>option1<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;option2&quot;</span>&gt;</span>option2<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span></div></li>
<li class="li1"><div class="de1"><span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">select</span>&gt;</span></div></li>
<li class="li2"><div class="de2"><span class="sc2">&lt;<span class="kw2">script</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;text/javascript&quot;</span> <span class="kw3">charset</span><span class="sy0">=</span><span class="st0">&quot;utf-8&quot;</span>&gt;</span></div></li>
<li class="li1"><div class="de1">/* <span class="sc-2">&lt;![CDATA[ */</span></div></li>
<li class="li1"><div class="de1"><span class="sc-2">&nbsp; &nbsp; function dosomething (argument) {</span></div></li>
<li class="li1"><div class="de1"><span class="sc-2">&nbsp; &nbsp; &nbsp; &nbsp; alert(&quot;Option &quot; + argument + &quot; selected&quot;);</span></div></li>
<li class="li1"><div class="de1"><span class="sc-2">&nbsp; &nbsp; }</span></div></li>
<li class="li2"><div class="de2"><span class="sc-2">/* ]]&gt;</span> */</div></li>
<li class="li1"><div class="de1"><span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">script</span>&gt;</span></div></li>
</ol></div></div>
  <div class='sourceblocklink'><a href='http://wiki.tamouse.org?n=Technology.QuickActionOnSelect?action=sourceblock&amp;num=1' type='text/plain'>raw code</a></div>
</div>

<div class='vspace'></div><h3>Before changing the option:</h3>
<p><a rel='nofollow' class='createlinktext' href='http://wiki.tamouse.org?n=Technology.QuickActionOnSelect?action=upload&amp;upname=before.png'>Attach:before.png</a><a rel='nofollow' class='createlink' href='http://wiki.tamouse.org?n=Technology.QuickActionOnSelect?action=upload&amp;upname=before.png'>&nbsp;&Delta;</a>
</p><h3>Result:</h3>
<p><a rel='nofollow' class='createlinktext' href='http://wiki.tamouse.org?n=Technology.QuickActionOnSelect?action=upload&amp;upname=after.png'>Attach:after.png</a><a rel='nofollow' class='createlink' href='http://wiki.tamouse.org?n=Technology.QuickActionOnSelect?action=upload&amp;upname=after.png'>&nbsp;&Delta;</a>
</p>
<p class='vspace'><a name='example' id='example'></a>
</p><h2>An Example</h2>
<p>Here's a specific example from some work I've done recently to enable fast theme switching based on applying a parameter to the current location's URL.
</p>
<div class='vspace'></div>
<div class='sourceblock ' id='sourceblock2'>
  <div class='sourceblocktext'><div class="php"><ol><li class="li1"><div class="de1"><span class="kw2">&lt;?php</span></div></li>
<li class="li1"><div class="de1">&nbsp;</div></li>
<li class="li1"><div class="de1"><span class="re0">$themes</span> <span class="sy0">=</span> <span class="kw3">array</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1"><span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$cssdir</span> <span class="sy0">=</span> <span class="kw3">opendir</span><span class="br0">&#40;</span><span class="st_h">'css'</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li>
<li class="li2"><div class="de2">&nbsp; &nbsp; <span class="kw1">while</span> <span class="br0">&#40;</span><span class="re0">$file</span> <span class="sy0">=</span> <span class="kw3">readdir</span><span class="br0">&#40;</span><span class="re0">$cssdir</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span><span class="kw3">preg_match</span><span class="br0">&#40;</span><span class="st_h">'/^theme_(.*)\.css$/'</span><span class="sy0">,</span> <span class="re0">$file</span><span class="sy0">,</span> <span class="re0">$matches</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="re0">$themes</span><span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="re0">$matches</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="br0">&#125;</span></div></li>
<li class="li2"><div class="de2">&nbsp;</div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="kw1">echo</span> <span class="st_h">'&lt;p&gt;Select a theme:'</span><span class="sy0">.</span>PHP_EOL<span class="sy0">;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="kw1">echo</span> <span class="st_h">'&lt;select name=&quot;themeswitcher&quot; id=&quot;themeswitcher&quot; onchange=&quot;settheme(this.value)&quot; size=&quot;1&quot;&gt;'</span><span class="sy0">.</span>PHP_EOL<span class="sy0">;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="re0">$themes</span> <span class="kw1">as</span> <span class="re0">$themename</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">echo</span> <span class="st_h">'&lt;option value=&quot;'</span><span class="sy0">.</span><span class="re0">$themename</span><span class="sy0">.</span><span class="st_h">'&quot;'</span><span class="sy0">.</span><span class="br0">&#40;</span><span class="re0">$themename</span> <span class="sy0">==</span> <span class="re0">$GLOBALS</span><span class="br0">&#91;</span><span class="st_h">'theme'</span><span class="br0">&#93;</span>?<span class="st_h">' selected '</span><span class="sy0">:</span><span class="st_h">''</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="st_h">'&gt;'</span><span class="sy0">.</span><span class="re0">$themename</span><span class="sy0">.</span><span class="st_h">'&lt;/option&gt;'</span><span class="sy0">.</span>PHP_EOL<span class="sy0">;</span> </div></li>
<li class="li2"><div class="de2">&nbsp; &nbsp; <span class="br0">&#125;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="kw1">echo</span> <span class="st_h">'&lt;/select&gt;'</span><span class="sy0">.</span>PHP_EOL<span class="sy0">;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="kw1">echo</span> <span class="st_h">'&lt;/p&gt;'</span><span class="sy0">.</span>PHP_EOL<span class="sy0">;</span></div></li>
<li class="li1"><div class="de1"><span class="sy1">?&gt;</span></div></li>
<li class="li1"><div class="de1">&nbsp;</div></li>
<li class="li2"><div class="de2">&lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot;&gt;</div></li>
<li class="li1"><div class="de1">/* &lt;![CDATA[ */</div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; function settheme &nbsp; (theme) {</div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; &nbsp; &nbsp; window.location=location.href + '&amp;theme=' + theme;</div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; }</div></li>
<li class="li2"><div class="de2">/* ]]&gt; */</div></li>
<li class="li1"><div class="de1">&lt;/script&gt;</div></li>
<li class="li1"><div class="de1">&nbsp;</div></li>
<li class="li1"><div class="de1"><span class="kw2">&lt;?php</span></div></li>
<li class="li1"><div class="de1">&nbsp;</div></li>
<li class="li2"><div class="de2"><span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span></div></li>
<li class="li1"><div class="de1">&nbsp; &nbsp; <span class="kw3">error_log</span><span class="br0">&#40;</span><span class="st0">&quot;ERROR: Could not open css directory<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li>
<li class="li1"><div class="de1"><span class="br0">&#125;</span></div></li>
<li class="li1"><div class="de1"><span class="sy1">?&gt;</span></div></li>
</ol></div></div>
  <div class='sourceblocklink'><a href='http://wiki.tamouse.org?n=Technology.QuickActionOnSelect?action=sourceblock&amp;num=2' type='text/plain'>raw code</a></div>
</div>

<p class='vspace'>In this example, I'm setting up a means for the user to choose a different theme than the one presented. The means to do this are by reloading the page with a query string parameter of <code>theme=<em>newtheme</em></code>. The various themes are held in the <code>css</code> subdirectory of the application, and have the file naming specification of "theme_" + theme name + ".css". This makes the theme choices easy to pick out amongst the other possible css and other files in the directory.
</p>
<p class='vspace'>The css directory is scanned, using the <code>readdir</code> function in php, which returns the files in the directory handle <code>$cssdir</code> one at a time. The file is run through <code>preg_match</code> to weed out the files we don't want, and when a matching file is found the theme name is extracted into the second element of the $matches array (subscript 1). This is appended to an array of theme names for use in setting the options below in the <code>&lt;select&gt;</code> block.
</p>
<p class='vspace'>A little label is given to show the user what to do. In this case, I do not use the alternative of setting the first option in the switch block to be some sort of instruction, as I need to have the current theme name selected. After the label, the select block is started. Of note is the <code>onchange</code> attribute, which is set to the javascript function we're going to call whenever the select block changes:
</p>
<div class='vspace'></div>
<div class='sourceblock ' id='sourceblock3'>
  <div class='sourceblocktext'><div class="html4strict">onchange=&quot;settheme(this.value)&quot;</div></div>
  <div class='sourceblocklink'><a href='http://wiki.tamouse.org?n=Technology.QuickActionOnSelect?action=sourceblock&amp;num=3' type='text/plain'>raw code</a></div>
</div>

<p class='vspace'>will call the <code>settheme</code> function with the currently selected value of the switch block. <code>this.value</code> is a particularly handy way of passing on that currently selected value.
</p>
<p class='vspace'>In the foreach loop, we have to check which option corresponds to the currently selected theme, so we can present the user with something to actually change. The currently selected theme is held in the php <code>$GLOBALS</code> array as key <code>theme</code>. The resulting HTML emitted looks like this:
</p>
<div class='vspace'></div>
<div class='sourceblock ' id='sourceblock4'>
  <div class='sourceblocktext'><div class="html4strict"><ol><li class="li1"><div class="de1"><span class="sc2">&lt;<span class="kw2">p</span>&gt;</span>Select a theme:</div></li>
<li class="li1"><div class="de1"><span class="sc2">&lt;<span class="kw2">select</span> <span class="kw3">name</span><span class="sy0">=</span><span class="st0">&quot;themeswitcher&quot;</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;themeswitcher&quot;</span> <span class="kw3">onchange</span><span class="sy0">=</span><span class="st0">&quot;settheme(this.value)&quot;</span> <span class="kw3">size</span><span class="sy0">=</span><span class="st0">&quot;1&quot;</span>&gt;</span></div></li>
<li class="li1"><div class="de1">&nbsp;</div></li>
<li class="li1"><div class="de1"><span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;dark&quot;</span> <span class="kw3">selected</span> &gt;</span>dark<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span></div></li>
<li class="li2"><div class="de2"><span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;purple&quot;</span>&gt;</span>purple<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span></div></li>
<li class="li1"><div class="de1"><span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">select</span>&gt;</span></div></li>
<li class="li1"><div class="de1"><span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">p</span>&gt;</span></div></li>
<li class="li1"><div class="de1">&nbsp;</div></li>
<li class="li1"><div class="de1"><span class="sc2">&lt;<span class="kw2">script</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;text/javascript&quot;</span> <span class="kw3">charset</span><span class="sy0">=</span><span class="st0">&quot;utf-8&quot;</span>&gt;</span></div></li>
<li class="li2"><div class="de2">/* <span class="sc-2">&lt;![CDATA[ */</span></div></li>
<li class="li1"><div class="de1"><span class="sc-2">&nbsp; &nbsp; function settheme &nbsp; (theme) {</span></div></li>
<li class="li1"><div class="de1"><span class="sc-2">&nbsp; &nbsp; &nbsp; &nbsp; window.location=location.href + '&amp;theme=' + theme;</span></div></li>
<li class="li1"><div class="de1"><span class="sc-2">&nbsp; &nbsp; }</span></div></li>
<li class="li1"><div class="de1"><span class="sc-2">/* ]]&gt;</span> */</div></li>
<li class="li2"><div class="de2"><span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">script</span>&gt;</span></div></li>
</ol></div></div>
  <div class='sourceblocklink'><a href='http://wiki.tamouse.org?n=Technology.QuickActionOnSelect?action=sourceblock&amp;num=4' type='text/plain'>raw code</a></div>
</div>

<p class='vspace'>As you can see, the currently selected theme is "purple" and the other option is "dark"
</p>
<div class='vspace'></div><h3>Before:</h3>
<p><a rel='nofollow' class='createlinktext' href='http://wiki.tamouse.org?n=Technology.QuickActionOnSelect?action=upload&amp;upname=examplebefore.png'>Attach:examplebefore.png</a><a rel='nofollow' class='createlink' href='http://wiki.tamouse.org?n=Technology.QuickActionOnSelect?action=upload&amp;upname=examplebefore.png'>&nbsp;&Delta;</a>
</p>
<div class='vspace'></div><h3>After</h3>
<p><a rel='nofollow' class='createlinktext' href='http://wiki.tamouse.org?n=Technology.QuickActionOnSelect?action=upload&amp;upname=exampleafter.png'>Attach:exampleafter.png</a><a rel='nofollow' class='createlink' href='http://wiki.tamouse.org?n=Technology.QuickActionOnSelect?action=upload&amp;upname=exampleafter.png'>&nbsp;&Delta;</a>
</p>
<p class='vspace'>You can see that the theme changed!
</p>
<div class='vspace'></div>
</div>

</body>
</html>
